<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/vue@2.6.10/dist/vue.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/p5.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" type="text/css" href="normalize.css">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

  <div class="container">

    <div id="dissonance">

      <div id="tangledsine" align="center"></div>

      <div id="title">
        <h1>Dissonance</h1>
        <h3>Calculate Consonant Musical Intervals Using a Sound's Spectrum</h3>
      </div>

      <h2>From Spectrum to Scale</h2>

      <p>In this page, we'll use the spectral properties of a sound to derive the musical scale that is most compatible with it. We can also work out what chords are the most consonant ones for this sound. In other words, we can use math to derive musical systems that are most compatible with real and imagined instruments. For our purposes here, a 'compatible' scale is one that minimizes the sensory dissonance that occurs when two sounds are played together.</p>

      <p>In the code below, we're inputting a harmonic sound, with partial frequencies f, 2f, 3f, 4f, 5f, 6f. In this default example, the partials are assumed to have equal amplitudes (i.e., they are equally loud). Try editing the code below and press Run. You can try changing the number of partials, their amplitudes (which should be between 0 and 1), or you can even try out inharmonic sounds! Whatever you enter here will affect the rest of this article.</p>

      <code-editor :code.sync="code"> </code-editor>

      <h2>Consonant Intervals</h2>
      <p>Below is a graph of the spectral dissonance that occurs when the sound that you input above is played together with a second version of itelf. The frequency of the second sound is varied with respect to the first along the horizontal x-axis. The vertical y-axis measures the dissonance between the two sounds. If you hover over the dips in this graph, you'll discover consonant musical intervals. When you play the two sounds together at these special musical intervals, they'll sound more consonant, and when you play them at other intervals, they'll sound more dissonant. So together, these dips make up a special musical scale –– one that is most 'compatible' with this sound.</p>

      <graph-intervals :data="data2d" :intervals="consonantIntervals"></graph-intervals>

      <p>The table below lists these optimal musical intervals, obtained from the dips in the dissonance graph above (also highlighted in orange).</p>

      <interval-table :intervals="consonantIntervals"></interval-table>

      </br>
      <p>Notice that if the original sound has a harmonic spectrum, then the interval ratios end up being the well known <a href="https://pages.mtu.edu/~suits/scales.html">"Just Intonation"</a>. In other words, we can view Just Intonation as the unique musical scale that minimizes dissonance for a pure harmonic sound.</p>

      <h2>Consonant Triads</h2>

      <p>Next, let's think about Musical Triads, i.e. musical chords that comprise of 3 notes played together. So, instead of playing two notes together like we did for musical intervals, we instead play three virtual notes together, where the frequencies of the second and the third notes are varied with respect to the first. Rather than creating a 2d dissonance graph like before, now we get a 3d dissonance surface! </p>

      <p>Take a look.</p>

      <graph-triads :data="data3d" :triads="consonantTriads">
        <p>This is the dissonance surface for the sound that we input above. Every point on this surface is a possible triad, i.e. a combination of three notes (there are infinitely many possibilities, because frequency varies continuously). The bottom of the valleys (shown in blue) correspond to more consonant musical chords, while the hills and mountain peaks (shown in red) correspond to more dissonant chords. You can drag the graph to rotate it and look under it.</p>

        <p>What we're after here are the valleys –– these are the least dissonant musical triads or chords. However, it's a little hard to identify thesee valleys from the view above. So instead, let's take a look at a heatmap of the same dissonance surface.</p>
      </graph-triads>

      <p>Hover over dark blue areas in the heatmap below to identify consonant musical triads.</p>

      <p>The table below provides information on the identified consonant triads, ranked in increasing order of dissonance.</p>

      <triad-table :triads="consonantTriads"></triad-table>

      <h2>References</h2>
      <p>The algorithm used in this article is developed by William Sethares and explained in detail in his excellent book <a href ="http://sethares.engr.wisc.edu/ttss.html">Tuning, Timbre, Spectrum, Scale</a>. I pulled values of parameters from this <a href="https://gist.github.com/endolith/3066664">Python port</a> of Sethares' work. The code for this page is available on <a href="https://github.com/aatishb/dissonance">Github</a>.</p>

    </div>
  </div>

  <!-- page code -->
  <script src="helper.js"></script>
  <script src="components.js"></script>
  <script src="main.js"></script>

  <!-- p5 header -->
  <script type="text/javascript" src="tangledsine.js"></script>
  <script type="text/javascript"> new p5(tangledsine, "tangledsine"); </script>


  <script type="text/javascript">javascript:(function(){var script=document.createElement('script');script.onload=function(){var stats=new Stats();stats.domElement.style.cssText='position:fixed;left:0;top:0;z-index:10000';document.body.appendChild(stats.domElement);requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};script.src='//rawgit.com/mrdoob/stats.js/master/build/stats.min.js';document.head.appendChild(script);})()
</script>

</body>
</html>